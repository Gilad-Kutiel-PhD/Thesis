We consider the Submodular Function Under
Knapsack Constraint Maximization problem.
For a given instance we denote by $O$ an optimal solution and for the rest of the 
paper we assume that the cost function is in the range $[0, b]$.
 
If it is clear from the context we use $x$ to denote the set $\{x\}$. 
We use the notation $f(B|A)$ to denote $f(A \cup B) - f(A)$, that is the marginal value of $B$
given $A$. 
For a set of elements, $A$, we use $c(A)$ to denote $\sum_{e \in A}c(e)$.
For an ordered set $A = \{a_1, \dots, a_k\}$ we use $A_i$ to denote the subset 
$\{a_1, \dots, a_i\}$, $A_0$ denotes the empty set.
We refer to the cost function in terms of value (e.g. cheap, expensive, most valuable, etc...) and 
to the weight function in terms of size (e.g. small, medium, larger, etc...) 

The greedy algorithm from \cite{khuller1999budgeted} and \cite{krause2005note}
is described in Algorithm \ref{alg:greedy}.

\begin{algorithm}[H]
\label{alg:greedy}

\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}

\Input{$U = \{e_1, \dots, e_n\}$, $f:2^U\to \mathbb{R}_+$, $c:U \to \mathbb{R}_+$}
\Output{$S \subseteq U$}

initialization: $S \leftarrow \emptyset$
\\
\While{$U \neq \emptyset$}{
	$e' \leftarrow \displaystyle{\arg\max_{e \in U}}\frac{f(e|S)}{c(e)}$
	\\
	$U \leftarrow U \setminus e'$
	\\
	\If{$c(S \cup \{e'\})\leq 1$}{
	\label{line:dropped}
		$S \leftarrow S \cup \{e'\}$
	}
}
\Return{S}
\caption{Greedy Algorithm}
\end{algorithm}
 
If the condition on line \ref{line:dropped} is evaluated to false we say that
the algorithm \emph{dropped} the element $e'$.
It can be shown that in general the approximation ratio of the greedy algorithm 
can be arbitrarily bad.

Let $S$ be the output of the greedy algorithm, the \emph{Modified Greedy} algorithm 
from \cite{khuller1999budgeted} and \cite{krause2005note} 
returns the best among the output of the greedy algorithm and the best singleton, 
that is $\arg\max\{S, \displaystyle{\arg\max_{e \in U}}f(\{e\})\}$.
This algorithm is described in Algorithm~\ref{alg:mgreedy}.  

\begin{algorithm}[H]
\label{alg:mgreedy}

\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}

\Input{$U = \{e_1, \dots, e_n\}$, $f:2^U\to \mathbb{R}_+$, $c:U \to \mathbb{R}_+$}
\Output{$S \subseteq U$}

$S \leftarrow \text{greedy}(U, f, c)$
\\
\Return{$\arg\max\{S, \displaystyle{\arg\max_{e \in U}}f(\{e\})\}$}
\caption{Modified Greedy Algorithm}
\end{algorithm}

The following lemma plays an important roll in the rest of this paper.

\begin{lemma}
\label{lemma:sub-main}
Let $A = \{a_1, \dots, a_k\}$ and $B$ be two subsets such that for all $1 \leq i \leq k$ 
and for all $e \in B$ it holds that 
$\frac{f(a_i|A_{i-1})}{c(a_i)} \geq \frac{f(e|A_{i-1})}{c(e)}$
then $f(A) \geq (1 - e^{-\frac{c(A)}{c(B)}})f(B)$.
\end{lemma} 

\begin{proof}
Consider the $i$th iteration and observe that 
\begin{align}
	\frac{f(e_i|A_{i-1})}{c(e_i)}c(B) 
	& = \sum_{e \in B} \frac{f(e_i|A_{i-1})}{c(e_i)}c(e)
	\label{ineq:main:greedy}
	\\ 	& \geq \sum_{e \in B} \frac{f(e|A_{i-1})}{c(e)}c(e)
	\label{ineq:main:sub}
	\\	& \geq f(B|A_{i-1})
	\label{ineq:main:mon}
	\\ 	& \geq f(B) - f(A_{i-1})
\end{align}
Where inequality \ref{ineq:main:greedy} is due to the greedy algorithm, inequality \ref{ineq:main:sub} is due to submodularity of $f$ and inequality \ref{ineq:main:mon} is due to monotonicity of $f$.
Thus $f(e_i|A_{i-1} \geq \frac{c(e_i)}{c(B)}(f(B) - f(A))$ and

$$
f(B) - f(A_i)  \leq (f(B) - f(A_{i - 1}))(1 - \frac{c(e_i)}{c(B)})
$$
and by induction
$$
f(B) - f(A_i)  \leq f(B) \prod_{j = 1}^{i}(1 - \frac{c(e_j)}{c(B)})
$$
using the inequality $1 - x \leq e^{-x}$ we get
$$
f(B) - f(A_i)  \leq f(B) (e^{-\sum_{j = 1}^{i}\frac{c(e_j)}{c(B)}})
$$
rearranging the terms and setting $i = k$ completes the proof.
\end{proof}

In particular, if $A$ is the set of elements chosen by the greedy algorithm in 
the $k$ first iterations and let $B$ be any subset such that no element from $B$ was dropped
by the greedy algorithm, 
then Lemma~\ref{lemma:sub-main} can be applied on $A$ and $B$.   




