We now present a $(1-e^{-2/3})$-approximation algorithm that runs in $O(n^2)$ time.
From now on we assume that an optimal solution contains an element larger than $(1/3)c(O)$ or otherwise, by Lemma~\ref{lemma:sub-main}, we can obtain such approximation ratio by the greedy algorithm.

The Bucket Algorithm~\ref{alg:bucket} divide all pairs of elements into (a constant number) buckets.
Then, from each bucket, it takes the smallest pair (i.e. the pair that minimizes $c$) and completes it using the Modified$^2$ Greedy algorithm.
Finally it returns the best solution among the above solution and the solution of the Modified$^2$ Greedy algorithm starting from an empty set.

\begin{algorithm}
	\label{alg:bucket}
	\caption{Bucket$(U, f, c, \beta, w_{\min}, \epsilon)$}
	$w_{\max} \leftarrow \max_{\{a, b\} \in U}f(\{a, b\})$
	\\
	\For{$i \in \{0,\dots,\log_{1 + \epsilon}\frac{w_{\max}}{w_{\min}}\}$}{
		$P_i \leftarrow \emptyset$
	}
	\\
	\For{$P = \{a,b\} \in U$}{
		$i \leftarrow \floor{\log_{1 + \epsilon}\frac{f(P)}{w_{\min}}}$
		\\
		\eIf{$P_i == \emptyset$}{
			$P_i \leftarrow P$
		}{
			$P_i \leftarrow \displaystyle{\argmin_{Q \in \{P_i, P\}}c(Q)}$
		}
	}
	\\
	\For{$P_i$}{
		$S_i \leftarrow P_i \cup \text{Modified}^2\text{Greedy}(U \setminus P_i, f_{P_i}, c, \beta - c(P_i))$
	}
	$M \leftarrow \text{Modified$^2$ Greedy}(U, f, c)$
	\\
	$T \leftarrow \arg\max\{M, \arg\max_{S_i}f(S_i)\}$
	\\
	\Return{T}
\end{algorithm}

To analyze the performance of the Bucket algorithm we start by showing that,  under certain conditions, the Modified$^2$ Greedy algorithm gives $1 - e^{-2/3}$-approximation ratio.
For the rest of this section we fix an optimal solution, $O$, and denote by $P$ its two largest elements.
Now consider the third largest element in $O$, and denote its size by $(1/3 - \delta)c(O)$.
Finally let $A$ be the output of the greedy algorithm, then we have the following lemma

\begin{lemma}
	\label{eq:sub:greedy}
	If the largest element in $O$ is bigger than $1/3$ then
	\begin{align*}
		f(A) & \geq (1-e^{-\frac{2/3 + \delta}{1 - 1/3 - (1/3 - \delta)}})f(O|P)
		\\		& \geq (1 - e^{-3/2})f(O|P)
	\end{align*}
\end{lemma}

\begin{proof}
	The proof follows immediately from Lemma~\ref{lemma:sub-main}.
\end{proof}

We have the following corollary:
\begin{corollary}
	\label{corollary:greedy-good}
	If $f(O|P) \geq \frac{1-e^{-2/3}}{1-e^{-3/2}}f(O)$ then $f(A) \geq (1 - e^{-2/3})f(O)$.
\end{corollary}

Now, let $P^*$ be the most valuable pair in the ground set.
We show that if the value of $P^*$ is large enough compared to the value of $P$ and if the greedy algorithm fails to find a good solution then $P^*$ by itself is a good solution, formally:

\begin{lemma}
	\label{lemma:sub:alpha}
	If $f(A) < (1 - e^{-2/3})f(O)$ then there is a constant $\alpha$ such that if $f(P) < \alpha f(P^*)$ then $f(P^*) \geq (1 - e^{-2/3})f(O)$.
\end{lemma}

\begin{proof}
	By the assumptions and by Corollary \ref{corollary:greedy-good} we know that 
	\begin{align}
		f(O)	& = f(P) + f(O|P) 
		\\ 		& < \alpha f(P^*) + \frac{1-e^{-2/3}}{1-e^{-3/2}}f(O)
	\end{align}
	So for $\alpha \leq \frac{e^{-2/3} - e^{-3/2}}{(1-e^{-2/3})(1-e^{-3/2})} \approx 0.77$ it holds that $f(P^*) \geq (1 - e^{-2/3})f(O)$.
\end{proof}

We now develope another algorithm that returns a good solution when niter of the above conditions hold.
We refer to this algorithm as the \emph{Buckets Algorithm}.

The Bucket Algorithm carefully selects a constant number of pairs of elements and greedily add elements to them.
We assume that the size of the knapsack is 1.
Consider all pairs of elements, we describe now how to choose the relevant ones.

Let $\epsilon$ be constants to be determined later and $\alpha$ the constant determined in the proof of Lemma \ref{lemma:sub:alpha},
we group the pairs into $\log_{1 + \epsilon}\frac{1}{\alpha}$ buckets where the $i$th bucket contains all the pairs with value
between $\alpha (1 + \epsilon)^{i - 1}f(P^*)$ and $\alpha (1 + \epsilon)^{i}f(P^*)$.
Note that, in general, there are pairs of elements that are not assigned to any of the buckets.
Note also that if the modified modified algorithm fails then $P$ was put in one of the buckets.

Now, from each bucket we only consider a smallest pair (breaking tie arbitrarily).
Given such a pair, $P'$, we construct a new Knapsack problem of budget $\beta - c(P')$ and with respect to the function $f_{P'}$.
We use the modified modified algorithm to obtain a $(1-e^{-(1/2 + \eps)})$-approximation
solution to this problem and combine it with the initial pair to obtain a (candidate)
solution to the original problem.
The bucket algorithm returns the best of those solutions.
Let $M$ be the solution returned by the modified modified algorithm and let $B$ be the solution returned by the bucket algorithm then we have:

\begin{lemma}
	If $f(M) < (1 - e^{-2/3})f(O)$ then $f(B) \geq (1 - e^{-2/3})f(O)$
\end{lemma}

\begin{proof}
	Let $P'$ be the pair considered by the algorithm from the bucket of $P$ then we know that:
	\begin{enumerate}
		\item $c(P') \leq c(P)$
		\item $f(P') \geq \frac{1}{(1 + \epsilon)}w(P)$
	\end{enumerate}
	Let $S_{P'}$ be the solution produced by the algorithm from $P'$,
	then using Lemma~\ref{lemma:sub-main} and using the properties of $P$ we know that (for small enough $\epsilon$)
	\begin{align}
		f(S_{P'}) & \geq f(P') + (1-e^{-(1/2 + \eps)})(1 - f(P) - f(P'))
		\\ & 
		\geq \frac{1}{(1 + \epsilon)}f(P) + (1-e^{-(1/2 + \eps)})(1 - 2f(P))
		\label{eq:sub:bucket}
	\end{align}
	Setting $\epsilon$ to (say) $0.002$ and taking the maximum between \ref{eq:sub:bucket} and
	\ref{eq:sub:greedy} completes the proof as can be seen in Figure~\ref{fig:sub:bucket}.
\end{proof}

\begin{figure}
	\def\zeta{0.002}
	\caption{
		\label{fig:sub:bucket}
		Bucket Algorithm - Approximation Ratio
	}
	\begin{tikzpicture}
		\begin{axis}[
				width=\textwidth
				,domain=0:1
				,ymax=.55
				,ymin=0.3
				% 	,xmax=.51
				,xlabel=$\omega$
				,xtick distance=0.1
				,ytick distance=0.1
				,axis lines=left
				,grid=both
				,grid style={
						draw=gray!20
					}
				,minor tick num=5
				,legend pos=south west
				,legend entries={
						Bucket Algorithm
						,Greedy Algorithm
						,$(1 - e^{-2/3})$
					}
			]
			\addplot[blue, dashed]{(1 + \zeta)^(-2)*x + (1 - e^(-(1/2 + \eps))) * (1 - 2 * x)};
			\addplot[red, dotted]{(1 - exp(-1.5)) * (1 - x)};
			\addplot[green]{(1 - exp(-2/3))};
		\end{axis}
	\end{tikzpicture}
\end{figure}

From the discussions above we have the following theorem:

\begin{theorem}
	$\displaystyle{\arg\max_{\mathclap{A \in \{M, B\}}}}f(A) \geq (1 - e^{-2/3})f(O)$.
\end{theorem}
